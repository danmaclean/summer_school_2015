<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <title>Finding Causative Mutations: Assembling a draft genome in the Galaxy Interface</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <!-- ><link rel="alternate" type="application/rss+xml" title="Software Carpentry Blog" href="http://software-carpentry.org/feed.xml"/> -->
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
      <!--   <a href="http://software-carpentry.org" title="Software Carpentry">
          <img alt="Software Carpentry banner" src="img/software-carpentry-banner.png" />
      	</a> -->
      	<a href="http://summerschool.tsl.ac.uk" title="TSL Summer School 2015 - Finding Causative Mutations Using A Candidate SNP Approach">
      	<img alt="TSL Logo" src="img/logo.png">	
      	<a href="summerschool.tsl.ac.uk" title="Summer School 2015 @ TSL">
        </a>
        <span style="font-family:'Open Sans',sans-serif;font-size: 1.8em; font-weight: 400;">  </span> <span>Finding Causative Mutations With A Candidate SNP approach</span>
      </div>
      <article>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
                    <a href="index.html"><h1 class="title">Assembling a draft genome in the Galaxy Interface</h1></a>
          <h2 class="subtitle">Basic Read QC</h2>
          <section class="objectives panel panel-warning">
<div class="panel-heading">
<h2 id="learning-objectives"><span class="glyphicon glyphicon-certificate"></span>Learning Objectives</h2>
</div>
<div class="panel-body">
<ul>
<li>Understanding Fastq</li>
<li>Inspecting and interpreting the quality of sequence data with FASTQC</li>
</ul>
</div>
</section>
<h2 id="using-and-preparing-next-generation-sequence-reads-with-galaxy">Using and Preparing Next-Generation Sequence Reads With Galaxy</h2>
<p>Sequence data is the starting point for most pathogenomics experiments. The raw sequence data will often be assembled into a rough draft assembly before other analysis can be carried out on it. Assembly is a tricky and labour intensive job. The first task is to quality control our sequence reads to ensure that we are working with the best quality data.</p>
<p>During sequencing it is never possible to determine absolutely which base is found at that position in the process, rather the most likely base out of all the options is called. This uncertainty means that a measure of the quality of the call has been developed, the quality score. Each base in a sequence read has its own quality score. The actual number of the quality score is generated by a log transformation of the calculated probability of the read being wrong (Ewing et al., 1998). Quality scores generally fall in the range between 0 (very poor confidence in the base called) and 40 (very high confidence in the base called), though there are some practical complications to this scheme (Cock et al., 2010).</p>
<p>The sequence reads and quality scores are usually output from base callers into <code>fastq</code> format. The quality scores are provided in a list of characters that encode the score directly. The fastq format encodes the base qualities in single characters based on the ASCII code, a computing convention that assigns a unique number to each of the characters used in computing systems, for example the <code>!</code> character has the decimal number 33 in the ASCII code (Web Resource: The ASCII Table). The fastq format is complicated by a number of factors, first the codes must be offset since the first 32 characters of the ASCII set represent non-printable characters like system alerts and the offset is slightly different depending on the origin of the file. Also the range of numbers that the quality score can fall into differs depending on the provenance of the file, even down to the version of the basecalling pipeline that was used. The difficulties in this popular format and how to deal with them are laid out better elsewhere, but it is important that any user of these technologies is aware of the potential for confusion (Cock et al., 2010).</p>
<p>All the reads we use are paired-end <em>FASTQ</em> reads, in Sanger Quality scaling. FASTQ format is a multi-line description of the read. The first line starts with a ‘@’ and contains the sequence id. The second line contains the sequence of the read. The third line starts with a ‘+’ and then optionally contains the sequence id again. Line 4 encodes the quality values as ASCII characters.</p>
<pre><code>
 @HWI-EAS396_0001:6:1:11659:1311#0/1
 CCTCGGAGTGGAA...
 +HWI-EAS396_0001:6:1:11659:1311#0/1
 !~@£$%%£$%$%^^...
</code></pre>
<p>Paired-end reads are those in which the reads actually come in pairs with an approximate distance (in nucleotides) between them. This distance, known as the insert-size, is set during the sample preparation and refers to the size of DNA fragment cut from the gel for sequencing. The ‘paired-ends’ are then sequenced from either side of these fragments and hence if we have paired-end sequences of 75 nts from each end of the DNA fragment with a 350 nt gap between them, our insert-size will be ~500 nts. In this practical we will use two sets of reads with different insert sizes: one set of reads has 500 nt between paired reads and the other has 2000 nt between reads.</p>
<section class="challenge panel panel-success">
<div class="panel-heading">
<h2 id="challenge"><span class="glyphicon glyphicon-pencil"></span>Challenge</h2>
</div>
<div class="panel-body">
<h2 id="loading-in-the-sequence-reads-from-a-data-library">Loading in the Sequence reads from a data library</h2>
<p>We will begin by accessing the data to use in the tutorial, it has been pre-loaded into a Galaxy Data Library</p>
<ul>
<li>First, create a new history by going to the History box, clicking on the ‘Options’ dropdown list and selecting ‘Create New’.</li>
<li>From the Galaxy main page, you will see some menus across the top of the page, the one of which should read ‘Shared Data’. Hover over this menu item and a drop down list of options should appear, the first of which should read ‘Data Libraries’, click it.</li>
<li>In the list of Data Libraries you will see one called EMBO training.</li>
<li>Click on this and you will see a couple of sub-folders. Next to the folder ‘Read QC’ click on the blue arrow-head and check the box next to ‘left_500_insert.fq’, ‘right_500_insert.fq’, ‘left_2000_insert.fq’, ‘right_2000_insert.fq’. Make sure ‘Import to current history’ is selected in the box below and click on ‘Go’. A green bar signalling that your task has been performed successfully will appear at the top of your screen. Click on ‘Analyze Data’ in the menu to return to the main interface.</li>
<li>You will be taken back to your homepage where you should see the four fastq files in your history.</li>
<li>Check the attributes of the files (pencil icon), they will need to be annotated as <code>fastqsanger</code> format to be used.</li>
</ul>
</div>
</section>
<h2 id="quality-control---using-quality-score">Quality Control - Using Quality Score</h2>
<p>Our data is paired-end and therefore contains reads in two files. We want to work with good data, so would like to get rid of sequences where the quality drops too low. The Quality Scores range from 0 to 40, with 0 being very poor and 40 being very good. We have two options, we can entirely throw away a read that contains bases whose quality drops below a threshold or trim the read at the first base that falls below the threshold. We’ll trim the reads with the Fastq Quality Trimmer tool to trim.</p>
<section class="challenge panel panel-success">
<div class="panel-heading">
<h2 id="challenge-1"><span class="glyphicon glyphicon-pencil"></span>Challenge</h2>
</div>
<div class="panel-body">
<ul>
<li>Click on ‘NGS:QC and manipulation’ in the toolbox. Select ‘FASTQ Quality Trimmer by sliding window’.</li>
<li>An explanation of the FASTQ trimmer tool appears in the centre console of our Galaxy page along with a description of the input and output formats. At the top of the page there are dropdown lists of what data we can trim.</li>
<li>Select from the drop down list the reads to trim (e.g. for ‘Left-hand Reads’ select ‘left_500_insert.fq’).</li>
<li>Set ‘Trim ends’ to ‘3’ only’, ‘Window size’ and ‘Step size’ to 1, ‘Aggregate Action’ to ‘mean’ and ‘Trim until’ to <code>&gt;=</code>. Finally set ‘Quality Score’ to 20. This action will remove the ends of reads where the average quality score falls below 20. Press execute, the job is queued and then run.</li>
<li>Do this for all read files.</li>
<li>When it finishes, click on the dataset name (something like “FastQ Joiner on…”) and you will see a summary of the data.</li>
<li>Repeat this for both sets of joined reads.</li>
</ul>
</div>
</section>
<section class="challenge panel panel-success">
<div class="panel-heading">
<h2 id="challenge-2"><span class="glyphicon glyphicon-pencil"></span>Challenge</h2>
</div>
<div class="panel-body">
<h2 id="editing-the-history">Editing the history</h2>
<p>When the history gets quite long, it can get confusing as to which downstream dataset has resulted from which dataset upstream, so we can edit the names of our history items. Lets try it. We’ll start by renaming our trimmed fastq data. In each box you will see the dataset number, the dataset name and then 3 symbols - an eye (which displays the data in the central page), a pen (which edits the dataset attributes), and a cross (which deletes the box from the history). + In the history box which has the dataset ‘FASTQ trimmer on dataset ..’, click on the pen symbol. This will take us to the ‘Edit Attributes’ page. In the ‘Name:’ box remove the current name and type in a suitable name e.g ‘Trimmed left reads 500 insert’. You can also edit other attributes on this page. Have a look at the various attributes, but don’t change anything. Click ‘Save’. + Note that the name of the dataset has changed but the dataset number has not. + Do the same for the other trimmed read history items.</p>
</div>
</section>
<h2 id="checking-the-quality-of-the-reads">Checking the quality of the reads</h2>
<p>Now we have reads with the correct length and after QC we can view the data graphically to check the quality of the data. We will do this by producing a summary statistics file and then use this to create a boxplot of the distribution of quality scores.</p>
<section class="challenge panel panel-success">
<div class="panel-heading">
<h2 id="challenge-3"><span class="glyphicon glyphicon-pencil"></span>Challenge</h2>
</div>
<div class="panel-body">
<ul>
<li>Under ‘NGS:QC and manipulation’ and the sub-heading ‘Illumina data’ click on ‘FASTQ Summary Statistics’. The output of the file will contain a number of fields that are explained on the Fastq Summary Statistics page. Take some time to look over them. Select the previously filtered fastq files and execute.</li>
<li>We can now examine the quality of the data by creating a boxplot of the summary statistics output file. Select ‘Graph/Display Data’ and click on ‘Boxplot of quality statistics’. We are presented with a number of dropdown lists, most of which should have default settings for which columns to use for which data.</li>
<li>In the ‘Plot outliers’ box, change the selection to ‘Don’t plot outliers’. Finally, make sure the FASTQ Summary Statistics file is selected in the ‘Quality Statistics File:’ list and hit Execute.</li>
<li>When the Boxplot box turns green, view the plot in the central console by clicking on the eye symbol next to the dataset name. We can now see the boxplot of quality scores. The solid red boxes represent the Inter-quartile range (IQR), with the top and bottom of the red boxes representing the upper and lower quartile values respectively. The solid black line inside the red boxes are the median quality scores, with the upper and lower whiskers representing 1.5 times the value of the IQR. Illumina such as these reads generally have better quality scores at the start which then deteriorate towards the end.</li>
</ul>
</div>
</section>
<section class="challenge panel panel-success">
<div class="panel-heading">
<h2 id="challenge-4"><span class="glyphicon glyphicon-pencil"></span>Challenge</h2>
</div>
<div class="panel-body">
<h2 id="getting-a-comprehensive-set-of-statistics-on-read-quality">Getting a comprehensive set of statistics on read quality</h2>
<ul>
<li>Select the <code>Fastqc: Fastqc QC using FastQC</code> tool, it only has one option, the read file to examine, so select the filtered reads from earlier steps.</li>
<li>If all goes well you will get a series of outputs. These describe various features of the sequence, including the per base Quality Scores we’ve already seen in the boxplots, but also important things like GC content, and duplication and over-representation statistics. Examine these statistics.</li>
</ul>
</div>
</section>
        </div>
      </div>
      </article>
      <div class="footer">
        <!-- <a class="label swc-blue-bg" href="http://software-carpentry.org">Software Carpentry</a> -->
        <a class="label swc-blue-bg" href="https://github.com/swcarpentry/lesson-template">Source</a>
        <!-- <a class="label swc-blue-bg" href="mailto:admin@software-carpentry.org">Contact</a> -->
        <a class="label swc-blue-bg" href="mailto:dan.maclean@tsl.ac.uk">Contact</a>
        <a class="label swc-blue-bg" href="LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="http://software-carpentry.org/v5/js/jquery-1.9.1.min.js"></script>
    <script src="css/bootstrap/bootstrap-js/bootstrap.js"></script>
  </body>
</html>
